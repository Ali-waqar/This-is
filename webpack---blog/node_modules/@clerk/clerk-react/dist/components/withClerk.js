"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.WithClerk = exports.withClerk = void 0;

var tslib_1 = require("tslib");

var react_1 = tslib_1.__importDefault(require("react"));

var IsomorphicClerkContext_1 = require("../contexts/IsomorphicClerkContext");

var StructureContext_1 = require("../contexts/StructureContext");

var errors_1 = require("../errors");

var withClerk = function withClerk(Component, displayName) {
    displayName = displayName || Component.displayName || Component.name || 'Component';
    Component.displayName = displayName;

    var HOC = function HOC(props) {
        var clerk = (0, IsomorphicClerkContext_1.useIsomorphicClerkContext)();

        if (!clerk.loaded) {
            return null;
        }

        return react_1.default.createElement(StructureContext_1.LoadedGuarantee, null, react_1.default.createElement(Component, Object.assign({}, props, {
            clerk: clerk
        })));
    };

    HOC.displayName = "withClerk(".concat(displayName, ")");
    return HOC;
};

exports.withClerk = withClerk;

var WithClerk = function WithClerk(_ref) {
    var children = _ref.children;
    var clerk = (0, IsomorphicClerkContext_1.useIsomorphicClerkContext)();

    if (typeof children !== 'function') {
        throw new Error(errors_1.hocChildrenNotAFunctionError);
    }

    if (!clerk.loaded) {
        return null;
    }

    return react_1.default.createElement(StructureContext_1.LoadedGuarantee, null, children(clerk));
};

exports.WithClerk = WithClerk;